defmodule Wanikani.SummaryTest do
  use ExUnit.Case

  defmodule MockApi do
    def request(_path) do
      {:ok,
       %{"data" => %{"lesson_subject_ids" => [1721, 1739, 1714, 6144, 1715, 1712,
            1726, 6245, 6247, 6258, 6163, 6164, 6171, 6172, 6251, 7511, 6248, 6249,
            6213, 6256, 6221, 6222, 6215, 1731, 1732, 1725, 1723, 1722, 1708, 1724,
            1735, 1741, 1729, 1736, 1719, 6257, 6240, 6250, 6243, 6253, 6244, 6254,
            6246, 6255, 6241, 6242, 1720 ],
           "review_subject_ids" => [7747, 2492, 2491, 2473, 2476, 2486, 2469, 2482,
            2477, 2488, 2493, 2480, 2471, 2485, 2489, 2475, 2470, 2494, 3016, 2468,
            2487, 4604, 2503, 2504, 2497, 2505, 2525, 2540, 2539, 1158, 2620, 2601,
            2643, 2589, 7519, 2588, 2609, 2605, 2606, 2832, 2621, 2632, 2603, 3404,
            2857, 2875 ],
           "reviews_per_hour" => [%{"available_at" => "2017-12-12T13:00:00.000000Z",
              "subject_ids" => [5150, 5834, 5355, 6946, 6009, 7502]},
            %{"available_at" => "2017-12-12T14:00:00.000000Z",
              "subject_ids" => [711, 5673, 5817, 4346, 1662, 5112]},
            %{"available_at" => "2017-12-12T15:00:00.000000Z",
              "subject_ids" => [6220, 4148, 5252, 1703, 5820]},
            %{"available_at" => "2017-12-12T16:00:00.000000Z",
              "subject_ids" => [5019, 6224, 5764, 4082, 6055, 5771, 6225, 4135,
               7647]},
            %{"available_at" => "2017-12-12T17:00:00.000000Z",
              "subject_ids" => [3466, 1418, 1398, 5338]},
            %{"available_at" => "2017-12-12T18:00:00.000000Z",
              "subject_ids" => [8716, 5644, 3247, 8682, 4266, 4036]},
            %{"available_at" => "2017-12-12T19:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-12T20:00:00.000000Z",
              "subject_ids" => [4718]},
            %{"available_at" => "2017-12-12T21:00:00.000000Z",
              "subject_ids" => [6075]},
            %{"available_at" => "2017-12-12T22:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-12T23:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-13T00:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-13T01:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-13T02:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-13T03:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-13T04:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-13T05:00:00.000000Z",
              "subject_ids" => [1395, 4642, 4321, 1414, 1075, 988, 5735, 7664, 6068,
               1677, 5189, 1018, 3592, 6085, 5066, 1337, 5796]},
            %{"available_at" => "2017-12-13T06:00:00.000000Z",
              "subject_ids" => [7659, 1680, 4068, 4987, 3594, 5377, 1444, 5359, 4245,
               4175, 5257, 3707, 5337, 1422, 1219, 6173, 6128, 6166]},
            %{"available_at" => "2017-12-13T07:00:00.000000Z",
              "subject_ids" => [7662, 8699, 4625, 6168, 5351, 5234, 4865, 5703, 1615,
               1544, 4218, 5518, 1697, 5736, 5680, 1704, 4043, 5485, 5847, 1354, 6203,
               5953, 6204, 7604, 7723]},
            %{"available_at" => "2017-12-13T08:00:00.000000Z",
              "subject_ids" => [5381, 5739, 6093]},
            %{"available_at" => "2017-12-13T09:00:00.000000Z",
              "subject_ids" => [4025, 296, 3138, 5839, 5242, 4879]},
            %{"available_at" => "2017-12-13T10:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-13T11:00:00.000000Z", "subject_ids" => []},
            %{"available_at" => "2017-12-13T12:00:00.000000Z", "subject_ids" => []}]},
         "data_updated_at" => "2017-12-12T12:00:00.000000Z", "object" => "report",
         "url" => "https://www.wanikani.com/api/v2/summary"}}
    end
  end

  test ".get" do
    {status, body} = Wanikani.Summary.get(MockApi)
    assert :ok == status
    assert "https://www.wanikani.com/api/v2/summary" == body["url"]
  end

end